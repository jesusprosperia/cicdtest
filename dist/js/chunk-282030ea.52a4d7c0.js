(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-282030ea"],{"31af":function(e,t,a){e.exports=a.p+"img/person.5c978daf.svg"},"83a1e":function(e,t,a){e.exports=a.p+"img/file-plus.7d0adc91.svg"},8792:function(e,t,a){},ad33:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{staticClass:"orgs"},[e.orgsLoading?e._e():r("div",{staticClass:"cards"},e._l(e.tiles,(function(t,a){return r("div",{key:"tile"+a,staticClass:"card-wrapper"},[r("b-card",{attrs:{title:t.name,"img-src":t.img,"img-alt":t.name,"img-top":""},on:{click:function(a){return e.onTileClick(t)}}},[t.edit?r("b-button",{staticClass:"dots-icon",attrs:{size:"sm",variant:"primary-outline"},on:{click:function(a){return e.onEditClick(a,t)}}},[r("b-icon",{attrs:{icon:"three-dots-vertical"}})],1):e._e()],1)],1)})),0),r("b-modal",{attrs:{size:"lg",title:"Add new organization"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"},[r("b-button",{staticClass:"float-right",attrs:{variant:"success",size:"sm"},on:{click:function(t){return e.onCreate()}}},[e._v("Create")]),r("b-button",{staticClass:"float-right mr-3",attrs:{variant:"secondary",size:"sm"},on:{click:function(t){return e.onCancel()}}},[e._v("Cancel")])],1)]},proxy:!0}]),model:{value:e.showAddOrgModal,callback:function(t){e.showAddOrgModal=t},expression:"showAddOrgModal"}},[r("b-form-group",{attrs:{"label-cols":"4",label:"Enter organization name","label-for":"org_name"}},[r("b-form-input",{attrs:{state:""!==e.orgModel.name,type:"text",id:"org_name",required:""},model:{value:e.orgModel.name,callback:function(t){e.$set(e.orgModel,"name",t)},expression:"orgModel.name"}})],1),r("b-form-group",{attrs:{"label-cols-sm":"4",label:"Organization logo"}},[r("div",{staticClass:"d-flex align-items-center"},[r("b-form-file",{attrs:{accept:".png, .jpg, .PNG, .JPG, .svg"},model:{value:e.orgLogo,callback:function(t){e.orgLogo=t},expression:"orgLogo"}}),r("div",{staticClass:"ml-2"},[r("img",{staticClass:"avatar",attrs:{src:e.orgLogoDisplay||a("cf05")}})])],1)]),e.updateOrg.profile_img_url?r("b-form-group",{attrs:{"label-cols-sm":"4",label:"Organization profile image"}},[r("div",{staticClass:"d-flex align-items-center"},[r("b-form-file",{attrs:{accept:".png, .jpg, .PNG, .JPG, .svg"},model:{value:e.orgProfile,callback:function(t){e.orgProfile=t},expression:"orgProfile"}}),r("div",{staticClass:"ml-2"},[r("img",{staticClass:"avatar",attrs:{src:e.orgProfileDisplay||a("cf05")}})])],1)]):e._e(),r("b-form-group",{attrs:{"label-cols":"4",label:"Primary color","label-for":"primary_color"}},[r("b-form-input",{attrs:{state:""!==e.orgModel.attrs.primary_color,type:"color",id:"primary_color",required:""},model:{value:e.orgModel.attrs.primary_color,callback:function(t){e.$set(e.orgModel.attrs,"primary_color",t)},expression:"orgModel.attrs.primary_color"}})],1),r("b-form-group",{attrs:{"label-cols":"4",label:"Secondary color","label-for":"secondary_color"}},[r("b-form-input",{attrs:{state:""!==e.orgModel.attrs.secondary_color,type:"color",id:"secondary_color",required:""},model:{value:e.orgModel.attrs.secondary_color,callback:function(t){e.$set(e.orgModel.attrs,"secondary_color",t)},expression:"orgModel.attrs.secondary_color"}})],1),r("b-form-group",{attrs:{"label-cols":"4",label:"Max number of users","label-for":"max_users"}},[r("b-form-input",{attrs:{state:e.orgModel.attrs.max_users>0,type:"number",id:"max_users",required:""},model:{value:e.orgModel.attrs.max_users,callback:function(t){e.$set(e.orgModel.attrs,"max_users",t)},expression:"orgModel.attrs.max_users"}})],1),r("b-form-group",{attrs:{"label-cols":"4",label:"Max dataset size (MB)","label-for":"max_dataset_size"}},[r("b-form-input",{attrs:{state:e.orgModel.attrs.max_dataset_size>0,type:"number",id:"max_dataset_size",required:""},model:{value:e.orgModel.attrs.max_dataset_size,callback:function(t){e.$set(e.orgModel.attrs,"max_dataset_size",t)},expression:"orgModel.attrs.max_dataset_size"}})],1),r("b-form-group",{attrs:{"label-cols":"4",label:"Max number of datasets","label-for":"max_datasets"}},[r("b-form-input",{attrs:{state:e.orgModel.attrs.max_datasets>0,type:"number",id:"max_datasets",required:""},model:{value:e.orgModel.attrs.max_datasets,callback:function(t){e.$set(e.orgModel.attrs,"max_datasets",t)},expression:"orgModel.attrs.max_datasets"}})],1),r("b-form-group",{attrs:{"label-cols":"4",label:"Max number of scenarios","label-for":"max_targeting_schemes"}},[r("b-form-input",{attrs:{state:e.orgModel.attrs.max_targeting_schemes>0,type:"number",id:"max_targeting_schemes",required:""},model:{value:e.orgModel.attrs.max_targeting_schemes,callback:function(t){e.$set(e.orgModel.attrs,"max_targeting_schemes",t)},expression:"orgModel.attrs.max_targeting_schemes"}})],1)],1),e.updateOrg?r("b-modal",{attrs:{size:"lg",title:"Update organization"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"},[r("b-button",{staticClass:"float-right",attrs:{variant:"success",size:"sm"},on:{click:function(t){return e.onUpdate()}}},[e._v("Update")]),r("b-button",{staticClass:"float-right mr-3",attrs:{variant:"secondary",size:"sm"},on:{click:function(t){return e.onEditCancel()}}},[e._v("Cancel")])],1)]},proxy:!0}],null,!1,2610432098),model:{value:e.showEditOrg,callback:function(t){e.showEditOrg=t},expression:"showEditOrg"}},[e.updateOrg.org_name?r("b-form-group",{attrs:{"label-cols":"4",label:"Enter organization name","label-for":"edit_org_name"}},[r("b-form-input",{attrs:{state:""!==e.updateOrgModel.name,type:"text",id:"edit_org_name",required:""},model:{value:e.updateOrgModel.name,callback:function(t){e.$set(e.updateOrgModel,"name",t)},expression:"updateOrgModel.name"}})],1):e._e(),e.updateOrg.logo_url?r("b-form-group",{attrs:{"label-cols-sm":"4",label:"Organization logo"}},[r("div",{staticClass:"d-flex align-items-center"},[r("b-form-file",{attrs:{accept:".png, .jpg, .PNG, .JPG, .svg"},model:{value:e.updateOrgLogo,callback:function(t){e.updateOrgLogo=t},expression:"updateOrgLogo"}}),r("div",{staticClass:"ml-2"},[r("img",{staticClass:"avatar",attrs:{src:e.updateOrgLogoDisplay||a("cf05")}})])],1)]):e._e(),e.updateOrg.profile_img_url?r("b-form-group",{attrs:{"label-cols-sm":"4",label:"Organization profile image"}},[r("div",{staticClass:"d-flex align-items-center"},[r("b-form-file",{attrs:{accept:".png, .jpg, .PNG, .JPG, .svg"},model:{value:e.updateOrgProfile,callback:function(t){e.updateOrgProfile=t},expression:"updateOrgProfile"}}),r("div",{staticClass:"ml-2"},[r("img",{staticClass:"avatar",attrs:{src:e.updateOrgProfileDisplay||a("cf05")}})])],1)]):e._e(),e.updateOrg.primary_color?r("b-form-group",{attrs:{"label-cols":"4",label:"Primary color","label-for":"edit_primary_color"}},[r("b-form-input",{attrs:{state:""!==e.updateOrgModel.attrs.primary_color,type:"color",id:"edit_primary_color",required:""},model:{value:e.updateOrgModel.attrs.primary_color,callback:function(t){e.$set(e.updateOrgModel.attrs,"primary_color",t)},expression:"updateOrgModel.attrs.primary_color"}})],1):e._e(),e.updateOrg.secondary_color?r("b-form-group",{attrs:{"label-cols":"4",label:"Secondary color","label-for":"edit_secondary_color"}},[r("b-form-input",{attrs:{state:""!==e.updateOrgModel.attrs.secondary_color,type:"color",id:"edit_secondary_color",required:""},model:{value:e.updateOrgModel.attrs.secondary_color,callback:function(t){e.$set(e.updateOrgModel.attrs,"secondary_color",t)},expression:"updateOrgModel.attrs.secondary_color"}})],1):e._e(),e.updateOrg.max_users?r("b-form-group",{attrs:{"label-cols":"4",label:"Max number of users","label-for":"edit_max_users"}},[r("b-form-input",{attrs:{state:e.updateOrgModel.attrs.max_users>0,type:"number",id:"edit_max_users",required:""},model:{value:e.updateOrgModel.attrs.max_users,callback:function(t){e.$set(e.updateOrgModel.attrs,"max_users",t)},expression:"updateOrgModel.attrs.max_users"}})],1):e._e(),e.updateOrg.max_dataset_size?r("b-form-group",{attrs:{"label-cols":"4",label:"Max dataset size (MB)","label-for":"edit_max_dataset_size"}},[r("b-form-input",{attrs:{state:e.updateOrgModel.attrs.max_dataset_size>0,type:"number",id:"edit_max_dataset_size",required:""},model:{value:e.updateOrgModel.attrs.max_dataset_size,callback:function(t){e.$set(e.updateOrgModel.attrs,"max_dataset_size",t)},expression:"updateOrgModel.attrs.max_dataset_size"}})],1):e._e(),e.updateOrg.max_datasets?r("b-form-group",{attrs:{"label-cols":"4",label:"Max number of datasets","label-for":"edit_max_datasets"}},[r("b-form-input",{attrs:{state:e.updateOrgModel.attrs.max_datasets>0,type:"number",id:"edit_max_datasets",required:""},model:{value:e.updateOrgModel.attrs.max_datasets,callback:function(t){e.$set(e.updateOrgModel.attrs,"max_datasets",t)},expression:"updateOrgModel.attrs.max_datasets"}})],1):e._e(),e.updateOrg.max_targeting_schemes?r("b-form-group",{attrs:{"label-cols":"4",label:"Max number of scenarios","label-for":"edit_max_targeting_schemes"}},[r("b-form-input",{attrs:{state:e.updateOrgModel.attrs.max_targeting_schemes>0,type:"number",id:"edit_max_targeting_schemes",required:""},model:{value:e.updateOrgModel.attrs.max_targeting_schemes,callback:function(t){e.$set(e.updateOrgModel.attrs,"max_targeting_schemes",t)},expression:"updateOrgModel.attrs.max_targeting_schemes"}})],1):e._e(),e.userPermissions.delete_org&&"super_admin"===e.user.type?[r("hr"),r("b-form-group",{attrs:{label:"Delete Organization?","label-cols":"4"}},[r("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){e.deleteConfirmDialog=!0}}},[e._v("Delete")])],1)]:e._e()],2):e._e(),e.userPermissions.delete_org&&"super_admin"===e.user.type?r("b-modal",{attrs:{size:"lg",title:"Are you sure you want to delete this organization?"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"},[r("b-button",{staticClass:"float-right ml-2",attrs:{variant:"danger",size:"sm"},on:{click:function(t){return e.onDeleteClick()}}},[e._v("Delete")]),r("b-button",{staticClass:"float-right",attrs:{variant:"secondary",size:"sm"},on:{click:function(t){e.deleteConfirmDialog=!1,e.orgNameConfirm=null}}},[e._v("Cancel")])],1)]},proxy:!0}],null,!1,630302609),model:{value:e.deleteConfirmDialog,callback:function(t){e.deleteConfirmDialog=t},expression:"deleteConfirmDialog"}},[r("p",{staticClass:"text-danger"},[e._v("\n      This organization will be removed permanently and can't be restored!\n    ")]),r("p",{staticClass:"text-danger"},[e._v("It will also:")]),r("ul",{staticClass:"text-danger"},[r("li",[e._v("Delete all the "),r("strong",[e._v("users")]),e._v(" in that organization.")]),r("li",[e._v("Update all the "),r("strong",[e._v("other users")]),e._v(" that are not in that organization, but are admins of that organization.")]),r("li",[e._v("Delete all the "),r("strong",[e._v("schemes and collections")]),e._v(" assigned to that organization.")]),r("li",[e._v("Delete all the "),r("strong",[e._v("schemes and collections")]),e._v(" assigned to users of that organization.")])]),r("p",{staticClass:"text-danger"},[e._v("I am sure I want to delete this organization and I am aware of its consequences.")]),r("p",{staticClass:"text-danger"},[e._v("Please type below "),r("strong",[r("i",[e._v("delete "+e._s(e.updateOrgModel.name))])]),e._v(".")]),r("b-form-input",{model:{value:e.orgNameConfirm,callback:function(t){e.orgNameConfirm=t},expression:"orgNameConfirm"}})],1):e._e()],1)},o=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("96cf"),a("3b8d")),i=a("75fc"),l=(a("7f7f"),a("bd86")),n=a("2f62"),d=a("529c");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(l["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={data:function(){return{deleteConfirmDialog:!1,showAddOrgModal:!1,showEditOrg:!1,orgLogo:[],orgLogoDisplay:null,updateOrgLogo:[],updateOrgLogoDisplay:null,orgProfile:[],orgProfileDisplay:null,updateOrgProfile:[],updateOrgProfileDisplay:null,orgsLoading:!1,updateOrgModel:{name:"",org_id:"",attrs:{logo_url:"",profile_img_url:"",primary_color:"",secondary_color:"",max_users:10,max_dataset_size:50,max_datasets:10,max_targeting_schemes:10}},orgModel:{name:"",attrs:{logo_url:"",profile_img_url:"",primary_color:"#2c3e50",secondary_color:"#28a745",max_users:10,max_dataset_size:50,max_datasets:10,max_targeting_schemes:10}},orgNameConfirm:null}},computed:g(g(g({},Object(n["c"])(["userPermissions","currentUser"])),Object(n["d"])({user:function(e){return e.auth.user},orgs:function(e){return e.auth.orgs},userFromAdmin:function(e){return e.admin.userFromAdmin}})),{},{tiles:function(){var e={name:"My Workspace",img:a("31af"),cmd:"my-workspace",edit:!1},t={name:"Add New Org",img:a("83a1e"),edit:!1,cmd:"add-new"},r=this.orgs.map((function(e){return{id:e._id,name:e.name,img:e.attrs.profile_img_url,cmd:"open-org",edit:!0,model:e}})),o=[e].concat(Object(i["a"])(r));return"super_admin"===this.currentUser.type&&o.push(t),o},updateOrg:function(){return this.userPermissions.update_org}}),methods:g(g({},Object(n["b"])(["fetchOrgs","addOrg","editOrg","deleteOrg"])),{},{browseOrgPage:function(e){var t=e._id;this.$router.push("/scenarios/".concat(t))},onTileClick:function(e){switch(e.cmd){case"open-org":this.$router.push("/scenarios/".concat(e.id));break;case"my-workspace":this.$router.push("/scenarios/".concat(this.currentUser._id));break;case"add-new":this.showAddOrgModal=!0;break;default:break}},onCreate:function(){var e=this;this.orgModel.attrs=Object(d["a"])(this.orgModel.attrs,["max_users","max_dataset_size","max_datasets","max_targeting_schemes"]);var t=this.orgModel,a=t.name,r=t.attrs,o=r.primary_color,s=r.secondary_color,i=r.max_users,l=r.max_dataset_size,n=r.max_datasets,c=r.max_targeting_schemes,g=this.orgLogo instanceof File,u=this.orgProfile instanceof File;if(!(""===a||!g||!u||i<=0||l<=0||n<=0||c<=0||""===o||""===s)){var m=new FormData;m.append("image_file",this.orgLogo);var p=new FormData;p.append("image_file",this.orgProfile),this.addOrg({org:this.orgModel,image_file:m,profile_img_url:p}).then((function(){e.showAddOrgModal=!1}))}},onCancel:function(){this.showAddOrgModal=!1},onEditCancel:function(){this.showEditOrg=!1},onDeleteClick:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.updateOrgModel.org_id){e.next=2;break}return e.abrupt("return");case 2:this.orgNameConfirm&&(t=this.orgNameConfirm.trim(),t==="delete "+this.updateOrgModel.name&&this.deleteOrg(this.updateOrgModel.org_id).then((function(){a.showEditOrg=!1,a.orgNameConfirm=null,a.deleteConfirmDialog=!1})).catch((function(){a.orgNameConfirm=null})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onEditClick:function(e,t){e.stopPropagation(),this.updateOrgModel=Object.assign({},t.model),this.updateOrgModel.org_id=t.id,this.showEditOrg=!0,this.updateOrgProfileDisplay=t.model.attrs.profile_img_url,this.updateOrgLogoDisplay=t.model.attrs.logo_url},onUpdate:function(){var e=this;this.updateOrgModel.attrs=Object(d["a"])(this.updateOrgModel.attrs,["max_users","max_dataset_size","max_datasets","max_targeting_schemes"]);var t=this.updateOrgModel,a=t.id,r=t.name,o=t.attrs,s=o.primary_color,i=o.secondary_color,l=o.max_users,n=o.max_dataset_size,c=o.max_datasets,g=o.max_targeting_schemes,u=this.updateOrgLogo instanceof File,m=this.updateOrgProfile instanceof File;if(!(""===a&&""===r&&!u&&!m&&l<=0&&n<=0&&c<=0&&g<=0&&""===s&&""===i)){var p={org_id:this.updateOrgModel.org_id,org:this.updateOrgModel};if(u){var _=new FormData;_.append("image_file",this.updateOrgLogo),p.image_file=_}if(m){var f=new FormData;f.append("image_file",this.updateOrgProfile),p.profile_img_url=f}this.editOrg(p).then((function(){e.showEditOrg=!1}))}},loadImg:function(e,t){if(e){var a=new FileReader;a.onload=t,a.readAsDataURL(e)}},loadOrgs:function(){var e=this,t=this.currentUser.type;if("admin"===t||"super_admin"===t){var a={};"admin"===t&&(a.admin_rights=this.currentUser.admin_rights,a.admin_rights.indexOf(this.currentUser.org_id)&&a.admin_rights.push(this.currentUser.org_id)),this.orgsLoading=!0,this.fetchOrgs(a).then((function(){e.orgsLoading=!1})).catch((function(){e.orgsLoading=!1}))}}}),watch:{orgLogo:function(e){var t=this;this.loadImg(e,(function(e){t.orgLogoDisplay=e.target.result}))},updateOrgLogo:function(e){var t=this;this.loadImg(e,(function(e){t.updateOrgLogoDisplay=e.target.result}))},orgProfile:function(e){var t=this;this.loadImg(e,(function(e){t.orgProfileDisplay=e.target.result}))},updateOrgProfile:function(e){var t=this;this.loadImg(e,(function(e){t.updateOrgProfileDisplay=e.target.result}))},userFromAdmin:function(){this.loadOrgs()}},created:function(){this.loadOrgs()}},m=u,p=(a("d6c7"),a("af9a"),a("2877")),_=Object(p["a"])(m,r,o,!1,null,"d595026a",null);t["default"]=_.exports},af9a:function(e,t,a){"use strict";var r=a("bc07"),o=a.n(r);o.a},bc07:function(e,t,a){},d6c7:function(e,t,a){"use strict";var r=a("8792"),o=a.n(r);o.a}}]);